<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1. Perkenalan Dataset – Clustering and Classification: Bank Transactions Dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Clustering and Classification: Bank Transactions Dataset</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home (Project Overview)</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analysis-pages" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analysis Pages</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analysis-pages">    
        <li>
    <a class="dropdown-item" href="./[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari.html">
 <span class="dropdown-text">Cluster Analysis (Unsupervised)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./[Klasifikasi] Submission Akhir BMLP_Cinta Chantika Lestari.html">
 <span class="dropdown-text">Classification Model (Supervised)</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>1. Perkenalan Dataset</strong></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Tahap pertama, Anda harus mencari dan menggunakan dataset <strong>tanpa label</strong> dengan ketentuan sebagai berikut:</p>
<ol type="1">
<li><p><strong>Sumber Dataset</strong>:<br>
Dataset dapat diperoleh dari berbagai sumber, seperti public repositories (<em>Kaggle</em>, <em>UCI ML Repository</em>, <em>Open Data</em>) atau data primer yang Anda kumpulkan sendiri.</p></li>
<li><p><strong>Ketentuan Dataset</strong>:</p>
<ul>
<li><strong>Tanpa label</strong>: Dataset tidak boleh memiliki label atau kelas.</li>
<li><strong>Jumlah Baris</strong>: Minimal 1000 baris untuk memastikan dataset cukup besar untuk analisis yang bermakna.</li>
<li><strong>Tipe Data</strong>: Harus mengandung data <strong>kategorikal</strong> dan <strong>numerikal</strong>.
<ul>
<li><em>Kategorikal</em>: Misalnya jenis kelamin, kategori produk.</li>
<li><em>Numerikal</em>: Misalnya usia, pendapatan, harga.</li>
</ul></li>
</ul></li>
<li><p><strong>Pembatasan</strong>:<br>
Dataset yang sudah digunakan dalam latihan clustering (seperti customer segmentation) tidak boleh digunakan.</p></li>
</ol>
<section id="import-library" class="level1">
<h1><strong>2. Import Library</strong></h1>
<p>Pada tahap ini, Anda perlu mengimpor beberapa pustaka (library) Python yang dibutuhkan untuk analisis data dan pembangunan model machine learning.</p>
<div id="cell-5" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  <span class="co"># Mengimpor pustaka pandas untuk manipulasi dan analisis data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt  <span class="co"># Mengimpor pustaka matplotlib untuk visualisasi grafik</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> yellowbrick.cluster <span class="im">import</span> KElbowVisualizer <span class="co">#Mengimpor KElbowVisualizer untuk visualisasi metode Elbow</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, StandardScaler</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans, DBSCAN  <span class="co"># Mengimpor algoritma KMeans</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score  <span class="co"># Mengimpor silhouette_score untuk mengevaluasi hasil clustering</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> VarianceThreshold</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="memuat-dataset" class="level1">
<h1><strong>3. Memuat Dataset</strong></h1>
<p>Pada tahap ini, Anda perlu memuat dataset ke dalam notebook. Jika dataset dalam format CSV, Anda bisa menggunakan pustaka pandas untuk membacanya. Pastikan untuk mengecek beberapa baris awal dataset untuk memahami strukturnya dan memastikan data telah dimuat dengan benar.</p>
<p>Jika dataset berada di Google Drive, pastikan Anda menghubungkan Google Drive ke Colab terlebih dahulu. Setelah dataset berhasil dimuat, langkah berikutnya adalah memeriksa kesesuaian data dan siap untuk dianalisis lebih lanjut.</p>
<div id="cell-8" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'bank_transactions_data_2.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengecek beberapa baris awal dataset untuk memahami strukturnya dan memastikan data telah dimuat dengan benar.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionID</th>
<th data-quarto-table-cell-role="th">AccountID</th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">TransactionDate</th>
<th data-quarto-table-cell-role="th">TransactionType</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">DeviceID</th>
<th data-quarto-table-cell-role="th">IP Address</th>
<th data-quarto-table-cell-role="th">MerchantID</th>
<th data-quarto-table-cell-role="th">Channel</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">CustomerOccupation</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">PreviousTransactionDate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>TX000001</td>
<td>AC00128</td>
<td>14.09</td>
<td>2023-04-11 16:29:14</td>
<td>Debit</td>
<td>San Diego</td>
<td>D000380</td>
<td>162.198.218.92</td>
<td>M015</td>
<td>ATM</td>
<td>70</td>
<td>Doctor</td>
<td>81</td>
<td>1</td>
<td>5112.21</td>
<td>2024-11-04 08:08:08</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>TX000002</td>
<td>AC00455</td>
<td>376.24</td>
<td>2023-06-27 16:44:19</td>
<td>Debit</td>
<td>Houston</td>
<td>D000051</td>
<td>13.149.61.4</td>
<td>M052</td>
<td>ATM</td>
<td>68</td>
<td>Doctor</td>
<td>141</td>
<td>1</td>
<td>13758.91</td>
<td>2024-11-04 08:09:35</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>TX000003</td>
<td>AC00019</td>
<td>126.29</td>
<td>2023-07-10 18:16:08</td>
<td>Debit</td>
<td>Mesa</td>
<td>D000235</td>
<td>215.97.143.157</td>
<td>M009</td>
<td>Online</td>
<td>19</td>
<td>Student</td>
<td>56</td>
<td>1</td>
<td>1122.35</td>
<td>2024-11-04 08:07:04</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>TX000004</td>
<td>AC00070</td>
<td>184.50</td>
<td>2023-05-05 16:32:11</td>
<td>Debit</td>
<td>Raleigh</td>
<td>D000187</td>
<td>200.13.225.150</td>
<td>M002</td>
<td>Online</td>
<td>26</td>
<td>Student</td>
<td>25</td>
<td>1</td>
<td>8569.06</td>
<td>2024-11-04 08:09:06</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>TX000005</td>
<td>AC00411</td>
<td>13.45</td>
<td>2023-10-16 17:51:24</td>
<td>Credit</td>
<td>Atlanta</td>
<td>D000308</td>
<td>65.164.3.100</td>
<td>M091</td>
<td>Online</td>
<td>26</td>
<td>Student</td>
<td>198</td>
<td>1</td>
<td>7429.40</td>
<td>2024-11-04 08:06:39</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis-eda" class="level1">
<h1><strong>4. Exploratory Data Analysis (EDA)</strong></h1>
<p><strong>1. Memahami Struktur Data</strong> - Tinjau jumlah baris dan kolom dalam dataset.<br>
- Tinjau jenis data di setiap kolom (numerikal atau kategorikal).</p>
<div id="cell-11" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.sample(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionID</th>
<th data-quarto-table-cell-role="th">AccountID</th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">TransactionDate</th>
<th data-quarto-table-cell-role="th">TransactionType</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">DeviceID</th>
<th data-quarto-table-cell-role="th">IP Address</th>
<th data-quarto-table-cell-role="th">MerchantID</th>
<th data-quarto-table-cell-role="th">Channel</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">CustomerOccupation</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">PreviousTransactionDate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1766</th>
<td>TX001767</td>
<td>AC00348</td>
<td>46.96</td>
<td>2023-06-30 16:44:37</td>
<td>Debit</td>
<td>Las Vegas</td>
<td>D000286</td>
<td>217.233.219.196</td>
<td>M070</td>
<td>Online</td>
<td>46</td>
<td>Engineer</td>
<td>12</td>
<td>1</td>
<td>2028.92</td>
<td>2024-11-04 08:11:10</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2366</th>
<td>TX002367</td>
<td>AC00010</td>
<td>281.91</td>
<td>2023-01-12 17:10:03</td>
<td>Debit</td>
<td>Denver</td>
<td>D000312</td>
<td>24.148.92.177</td>
<td>M069</td>
<td>Branch</td>
<td>25</td>
<td>Student</td>
<td>269</td>
<td>1</td>
<td>225.53</td>
<td>2024-11-04 08:07:24</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">1562</th>
<td>TX001563</td>
<td>AC00112</td>
<td>554.15</td>
<td>2023-04-18 17:17:37</td>
<td>Debit</td>
<td>Raleigh</td>
<td>D000087</td>
<td>151.247.130.190</td>
<td>M066</td>
<td>ATM</td>
<td>49</td>
<td>Doctor</td>
<td>108</td>
<td>1</td>
<td>14817.22</td>
<td>2024-11-04 08:12:11</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan informasi tentang dataset, termasuk jumlah baris, kolom, tipe data, dan jumlah nilai non-null</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Apabila jumlah nilai non-null konsisten, maka kemungkinan besar tidak ada data yang null</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df.info()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>jumlah_baris, jumlah_kolom <span class="op">=</span> df.shape</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Jumlah Baris: </span><span class="sc">{</span>jumlah_baris<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Jumlah Kolom: </span><span class="sc">{</span>jumlah_kolom<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2512 entries, 0 to 2511
Data columns (total 16 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   TransactionID            2512 non-null   object 
 1   AccountID                2512 non-null   object 
 2   TransactionAmount        2512 non-null   float64
 3   TransactionDate          2512 non-null   object 
 4   TransactionType          2512 non-null   object 
 5   Location                 2512 non-null   object 
 6   DeviceID                 2512 non-null   object 
 7   IP Address               2512 non-null   object 
 8   MerchantID               2512 non-null   object 
 9   Channel                  2512 non-null   object 
 10  CustomerAge              2512 non-null   int64  
 11  CustomerOccupation       2512 non-null   object 
 12  TransactionDuration      2512 non-null   int64  
 13  LoginAttempts            2512 non-null   int64  
 14  AccountBalance           2512 non-null   float64
 15  PreviousTransactionDate  2512 non-null   object 
dtypes: float64(2), int64(3), object(11)
memory usage: 314.1+ KB

Jumlah Baris: 2512
Jumlah Kolom: 16</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan statistik deskriptif dari dataset untuk seluruh kolom</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df.describe(include<span class="op">=</span><span class="st">"all"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionID</th>
<th data-quarto-table-cell-role="th">AccountID</th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">TransactionDate</th>
<th data-quarto-table-cell-role="th">TransactionType</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">DeviceID</th>
<th data-quarto-table-cell-role="th">IP Address</th>
<th data-quarto-table-cell-role="th">MerchantID</th>
<th data-quarto-table-cell-role="th">Channel</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">CustomerOccupation</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">PreviousTransactionDate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>2512</td>
<td>2512</td>
<td>2512.000000</td>
<td>2512</td>
<td>2512</td>
<td>2512</td>
<td>2512</td>
<td>2512</td>
<td>2512</td>
<td>2512</td>
<td>2512.000000</td>
<td>2512</td>
<td>2512.000000</td>
<td>2512.000000</td>
<td>2512.000000</td>
<td>2512</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">unique</th>
<td>2512</td>
<td>495</td>
<td>NaN</td>
<td>2512</td>
<td>2</td>
<td>43</td>
<td>681</td>
<td>592</td>
<td>100</td>
<td>3</td>
<td>NaN</td>
<td>4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>360</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">top</th>
<td>TX002496</td>
<td>AC00460</td>
<td>NaN</td>
<td>2023-04-03 16:07:53</td>
<td>Debit</td>
<td>Fort Worth</td>
<td>D000548</td>
<td>200.136.146.93</td>
<td>M026</td>
<td>Branch</td>
<td>NaN</td>
<td>Student</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2024-11-04 08:09:17</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">freq</th>
<td>1</td>
<td>12</td>
<td>NaN</td>
<td>1</td>
<td>1944</td>
<td>70</td>
<td>9</td>
<td>13</td>
<td>45</td>
<td>868</td>
<td>NaN</td>
<td>657</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>16</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">mean</th>
<td>NaN</td>
<td>NaN</td>
<td>297.593778</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>44.673965</td>
<td>NaN</td>
<td>119.643312</td>
<td>1.124602</td>
<td>5114.302966</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">std</th>
<td>NaN</td>
<td>NaN</td>
<td>291.946243</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>17.792198</td>
<td>NaN</td>
<td>69.963757</td>
<td>0.602662</td>
<td>3900.942499</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">min</th>
<td>NaN</td>
<td>NaN</td>
<td>0.260000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>18.000000</td>
<td>NaN</td>
<td>10.000000</td>
<td>1.000000</td>
<td>101.250000</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25%</th>
<td>NaN</td>
<td>NaN</td>
<td>81.885000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>27.000000</td>
<td>NaN</td>
<td>63.000000</td>
<td>1.000000</td>
<td>1504.370000</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">50%</th>
<td>NaN</td>
<td>NaN</td>
<td>211.140000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>45.000000</td>
<td>NaN</td>
<td>112.500000</td>
<td>1.000000</td>
<td>4735.510000</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">75%</th>
<td>NaN</td>
<td>NaN</td>
<td>414.527500</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>59.000000</td>
<td>NaN</td>
<td>161.000000</td>
<td>1.000000</td>
<td>7678.820000</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">max</th>
<td>NaN</td>
<td>NaN</td>
<td>1919.110000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>80.000000</td>
<td>NaN</td>
<td>300.000000</td>
<td>5.000000</td>
<td>14977.990000</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengetahui jumlah unik AccountID dan TransactionID</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>jml_unik_accountid <span class="op">=</span> df[<span class="st">'AccountID'</span>].nunique()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>jml_unik_transactionid <span class="op">=</span> df[<span class="st">'TransactionID'</span>].nunique()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Jumlah unik AccountID: </span><span class="sc">{</span>jml_unik_accountid<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Jumlah unik TransactionID: </span><span class="sc">{</span>jml_unik_transactionid<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Jumlah unik AccountID: 495
Jumlah unik TransactionID: 2512</code></pre>
</div>
</div>
<p><strong>2. Menangani Data yang Hilang</strong> - Identifikasi dan analisis data yang hilang (<em>missing values</em>). Tentukan langkah-langkah yang diperlukan untuk menangani data yang hilang, seperti pengisian atau penghapusan data tersebut.</p>
<div id="cell-16" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>TransactionID              0
AccountID                  0
TransactionAmount          0
TransactionDate            0
TransactionType            0
Location                   0
DeviceID                   0
IP Address                 0
MerchantID                 0
Channel                    0
CustomerAge                0
CustomerOccupation         0
TransactionDuration        0
LoginAttempts              0
AccountBalance             0
PreviousTransactionDate    0
dtype: int64</code></pre>
</div>
</div>
<p>Tidak terdapat data yang null/NA. Apabila ada, maka nantinya akan ditangani pada bagian “Data Preprocessing”</p>
<p><strong>3. Analisis Distribusi dan Korelasi</strong> - Analisis distribusi variabel numerik dengan statistik deskriptif dan visualisasi seperti histogram atau boxplot.<br>
- Periksa hubungan antara variabel menggunakan matriks korelasi atau scatter plot.</p>
<p><strong>4. Visualisasi Data</strong> - Buat visualisasi dasar seperti grafik distribusi dan diagram batang untuk variabel kategorikal.<br>
- Gunakan heatmap atau pairplot untuk menganalisis korelasi antar variabel.</p>
<div id="cell-19" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan statistik deskriptif dari dataset untuk kolom numerik</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>2512.000000</td>
<td>2512.000000</td>
<td>2512.000000</td>
<td>2512.000000</td>
<td>2512.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>297.593778</td>
<td>44.673965</td>
<td>119.643312</td>
<td>1.124602</td>
<td>5114.302966</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>291.946243</td>
<td>17.792198</td>
<td>69.963757</td>
<td>0.602662</td>
<td>3900.942499</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>0.260000</td>
<td>18.000000</td>
<td>10.000000</td>
<td>1.000000</td>
<td>101.250000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>81.885000</td>
<td>27.000000</td>
<td>63.000000</td>
<td>1.000000</td>
<td>1504.370000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>211.140000</td>
<td>45.000000</td>
<td>112.500000</td>
<td>1.000000</td>
<td>4735.510000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>414.527500</td>
<td>59.000000</td>
<td>161.000000</td>
<td>1.000000</td>
<td>7678.820000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>1919.110000</td>
<td>80.000000</td>
<td>300.000000</td>
<td>5.000000</td>
<td>14977.990000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisasi variabel numerik</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifikasi kolom numerik</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>numerical_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'number'</span>]).columns</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan jumlah variabel numerik</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>num_numerical_vars <span class="op">=</span> <span class="bu">len</span>(numerical_cols)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan jumlah baris dan kolom untuk grid subplot</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>n_cols <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>n_rows <span class="op">=</span> <span class="op">-</span>(<span class="op">-</span>num_numerical_vars <span class="op">//</span> n_cols)  <span class="co"># Ceiling division untuk menentukan jumlah baris</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat subplot</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(n_rows, n_cols, figsize<span class="op">=</span>(<span class="dv">20</span>, n_rows <span class="op">*</span> <span class="dv">4</span>))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten axes array untuk memudahkan iterasi jika diperlukan</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histogram untuk setiap variabel numerik</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, column <span class="kw">in</span> <span class="bu">enumerate</span>(numerical_cols):</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    df[column].hist(ax<span class="op">=</span>axes[i], bins<span class="op">=</span><span class="dv">20</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(column)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(<span class="st">'Value'</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    axes[i].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghapus subplot yang tidak terpakai (jika ada)</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(axes)):</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    fig.delaxes(axes[j])</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyesuaikan layout agar lebih rapi</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Untuk membuat visualisasi yang lebih ringkas, dapat dilakukan <em>binning</em> nantinya pada variabel yang dikehendaki</p>
<div id="cell-22" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifikasi outlier menggunakan boxplot</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tentukan jumlah baris dan kolom untuk grid subplot</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>n_cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>n_rows <span class="op">=</span> <span class="op">-</span>(<span class="op">-</span>num_numerical_vars <span class="op">//</span> n_cols)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat subplot</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(n_rows, n_cols, figsize<span class="op">=</span>(<span class="dv">15</span>, n_rows <span class="op">*</span> <span class="dv">5</span>))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten axes array</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot boxplot untuk setiap variabel numerik</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, column <span class="kw">in</span> <span class="bu">enumerate</span>(numerical_cols):</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(x<span class="op">=</span>df[column], ax<span class="op">=</span>axes[i])</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(column)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(<span class="st">'Value'</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghapus subplot yang tidak terpakai</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(axes)):</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    fig.delaxes(axes[j])</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyesuaikan layout</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Outlier pada variabel TransactionAmount dan LoginAttempts wajar. Hal ini karena sistem perbankan melayani berbagai jenis pelanggan dengan kebutuhan transaksi yang berbeda, terdapat pelanggan yang melakukan pembelian atau transfer dengan jumlah yang besar. Outlier pada LoginAttempts yang menunjukkan angka percobaan login di atas satu merupakan hal normal karena kesalahan login dapat terjadi, baik dari pengguna maupun teknis. Namun, supaya meminimalisir kesalahan pada model clustering, outlier TransactionAmount yang ekstrim ini akan ditangani nantinya.</p>
<div id="cell-24" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hitung matriks korelasi</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df[numerical_cols].corr()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Buat heatmap</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, fmt<span class="op">=</span><span class="st">".2f"</span>, linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Matriks Korelasi Variabel Numerik'</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisasi variabel kategorik</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifikasi kolom kategorik</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>]).columns</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Kecualikan data yang memiliki sifat identifier unik/tidak relevan</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> categorical_cols <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">'TransactionID'</span>, <span class="st">'AccountID'</span>, <span class="st">'TransactionDate'</span>, <span class="st">'Location'</span>, <span class="st">'DeviceID'</span>, <span class="st">'IP Address'</span>, <span class="st">'MerchantID'</span>, <span class="st">'PreviousTransactionDate'</span>]]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan jumlah variabel kategorikal</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>num_categorical_vars <span class="op">=</span> <span class="bu">len</span>(categorical_cols)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan jumlah baris dan kolom untuk grid subplot</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>n_cols <span class="op">=</span> <span class="dv">2</span>  <span class="co"># Sesuaikan jumlah kolom sesuai preferensi</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>n_rows <span class="op">=</span> <span class="op">-</span>(<span class="op">-</span>num_categorical_vars <span class="op">//</span> n_cols)  <span class="co"># Ceiling division</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat subplot</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(n_rows, n_cols, figsize<span class="op">=</span>(<span class="dv">15</span>, n_rows <span class="op">*</span> <span class="dv">5</span>))  <span class="co"># Sesuaikan ukuran figure</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot bar chart (countplot) untuk setiap variabel kategorikal</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, column <span class="kw">in</span> <span class="bu">enumerate</span>(categorical_cols):</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    sns.countplot(data<span class="op">=</span>df, y<span class="op">=</span>column, order<span class="op">=</span>df[column].value_counts().index, ax<span class="op">=</span>axes[i])</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(<span class="ss">f'Distribusi </span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(<span class="st">'Jumlah'</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    axes[i].set_ylabel(column)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghapus subplot yang tidak terpakai</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(axes)):</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    fig.delaxes(axes[j])</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelasi antara CustomerAge, TransactionAmount, dan CustomerOccupation</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))  <span class="co"># Sesuaikan ukuran figure jika perlu</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'CustomerAge'</span>, y<span class="op">=</span><span class="st">'AccountBalance'</span>, hue<span class="op">=</span><span class="st">'CustomerOccupation'</span>, data<span class="op">=</span>df, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Menambahkan garis regresi (overall)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'CustomerAge'</span>, y<span class="op">=</span><span class="st">'AccountBalance'</span>, data<span class="op">=</span>df, scatter<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Tren Keseluruhan'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot: Usia vs. Jumlah Transaksi (Diwarnai Berdasarkan Pekerjaan)'</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Usia Pelanggan'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Jumlah Saldo'</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Pekerjaan Pelanggan'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)  <span class="co"># Menempatkan legenda di luar plot</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ada indikasi korelasi positif yang lemah hingga sedang antara usia pelanggan dan jumlah transaksi dalam dataset ini. Namun, variabel CustomerOccupation juga tampaknya memainkan peran dalam pola transaksi, dan korelasi mungkin berbeda untuk setiap kelompok pekerjaan.</p>
<div id="cell-28" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat figure dengan dua subplot berdampingan</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">7</span>))  <span class="co"># 1 baris, 2 kolom</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Subplot 1: Bar Chart Rata-rata AccountBalance berdasarkan CustomerOccupation</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>average_balance_by_occupation <span class="op">=</span> df.groupby(<span class="st">'CustomerOccupation'</span>)[<span class="st">'AccountBalance'</span>].mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>average_balance_by_occupation.index, y<span class="op">=</span>average_balance_by_occupation.values, color<span class="op">=</span><span class="st">'orange'</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Rata-rata Saldo Rekening Berdasarkan Pekerjaan'</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Pekerjaan Pelanggan'</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Rata-rata Saldo Rekening'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Subplot 2: Bar Chart Rata-rata TransactionAmount berdasarkan CustomerOccupation</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>average_transaction_by_occupation <span class="op">=</span> df.groupby(<span class="st">'CustomerOccupation'</span>)[<span class="st">'TransactionAmount'</span>].mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>average_transaction_by_occupation.index, y<span class="op">=</span>average_transaction_by_occupation.values, color<span class="op">=</span><span class="st">'coral'</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Rata-rata Jumlah Transaksi Berdasarkan Pekerjaan'</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Pekerjaan Pelanggan'</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Rata-rata Jumlah Transaksi'</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Rata-rata jumlah transaksi ternyata hanya berbeda tipis antar profesi, namun rata-rata saldo rekening lebih memiliki perbedaan yang signifikan. Dapat disimpulkan juga, jumlah saldo tidak terlalu memengaruhi besar transaksi yang dilakukan.</p>
</section>
<section id="data-preprocessing" class="level1">
<h1><strong>5. Data Preprocessing</strong></h1>
<p>Pada tahap ini, data preprocessing adalah langkah penting untuk memastikan kualitas data sebelum digunakan dalam model machine learning. Data mentah sering kali mengandung nilai kosong, duplikasi, atau rentang nilai yang tidak konsisten, yang dapat memengaruhi kinerja model. Oleh karena itu, proses ini bertujuan untuk membersihkan dan mempersiapkan data agar analisis berjalan optimal.</p>
<p>Berikut adalah tahapan-tahapan yang bisa dilakukan, tetapi <strong>tidak terbatas</strong> pada: 1. Menghapus atau Menangani Data Kosong (Missing Values) 2. Menghapus Data Duplikat 3. Normalisasi atau Standarisasi Fitur 4. Deteksi dan Penanganan Outlier 5. Encoding Data Kategorikal 6. Binning (Pengelompokan Data)</p>
<p>Cukup sesuaikan dengan karakteristik data yang kamu gunakan yah.</p>
<div id="cell-32" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>TransactionID              0
AccountID                  0
TransactionAmount          0
TransactionDate            0
TransactionType            0
Location                   0
DeviceID                   0
IP Address                 0
MerchantID                 0
Channel                    0
CustomerAge                0
CustomerOccupation         0
TransactionDuration        0
LoginAttempts              0
AccountBalance             0
PreviousTransactionDate    0
dtype: int64</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Jumlah duplikasi: "</span>, df.duplicated().<span class="bu">sum</span>())</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Jumlah duplikasi:  0</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>2512.000000</td>
<td>2512.000000</td>
<td>2512.000000</td>
<td>2512.000000</td>
<td>2512.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>297.593778</td>
<td>44.673965</td>
<td>119.643312</td>
<td>1.124602</td>
<td>5114.302966</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>291.946243</td>
<td>17.792198</td>
<td>69.963757</td>
<td>0.602662</td>
<td>3900.942499</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>0.260000</td>
<td>18.000000</td>
<td>10.000000</td>
<td>1.000000</td>
<td>101.250000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>81.885000</td>
<td>27.000000</td>
<td>63.000000</td>
<td>1.000000</td>
<td>1504.370000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>211.140000</td>
<td>45.000000</td>
<td>112.500000</td>
<td>1.000000</td>
<td>4735.510000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>414.527500</td>
<td>59.000000</td>
<td>161.000000</td>
<td>1.000000</td>
<td>7678.820000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>1919.110000</td>
<td>80.000000</td>
<td>300.000000</td>
<td>5.000000</td>
<td>14977.990000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghilangkan kolom/fitur kategorik yang kurang relevan/terlalu banyak kategori utk encoding</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>hapus_fitur <span class="op">=</span> [<span class="st">'TransactionID'</span>, <span class="st">'AccountID'</span>, <span class="st">'TransactionDate'</span>, <span class="st">'Location'</span>, <span class="st">'DeviceID'</span>, <span class="st">'IP Address'</span>, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">'MerchantID'</span>, <span class="st">'PreviousTransactionDate'</span>]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat salinan DataFrame</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>df_cleaned <span class="op">=</span> df.copy()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghilangkan fitur-fitur yang ada dalam daftar</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>df_cleaned <span class="op">=</span> df_cleaned.drop(columns<span class="op">=</span>[col <span class="cf">for</span> col <span class="kw">in</span> hapus_fitur <span class="cf">if</span> col <span class="kw">in</span> df_cleaned.columns], errors<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"DataFrame setelah menghilangkan fitur: </span><span class="sc">{</span>df_cleaned<span class="sc">.</span>shape<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned.head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>DataFrame setelah menghilangkan fitur: (2512, 8)

   TransactionAmount TransactionType Channel  CustomerAge CustomerOccupation  \
0              14.09           Debit     ATM           70             Doctor   
1             376.24           Debit     ATM           68             Doctor   
2             126.29           Debit  Online           19            Student   
3             184.50           Debit  Online           26            Student   
4              13.45          Credit  Online           26            Student   

   TransactionDuration  LoginAttempts  AccountBalance  
0                   81              1         5112.21  
1                  141              1        13758.91  
2                   56              1         1122.35  
3                   25              1         8569.06  
4                  198              1         7429.40  </code></pre>
</div>
</div>
<div id="cell-35" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> df_cleaned.select_dtypes(include<span class="op">=</span><span class="st">'object'</span>).columns</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_cleaned[categorical_cols]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionType</th>
<th data-quarto-table-cell-role="th">Channel</th>
<th data-quarto-table-cell-role="th">CustomerOccupation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Debit</td>
<td>ATM</td>
<td>Doctor</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Debit</td>
<td>ATM</td>
<td>Doctor</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Debit</td>
<td>Online</td>
<td>Student</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Debit</td>
<td>Online</td>
<td>Student</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Credit</td>
<td>Online</td>
<td>Student</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2507</th>
<td>Credit</td>
<td>Branch</td>
<td>Doctor</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2508</th>
<td>Debit</td>
<td>Branch</td>
<td>Doctor</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2509</th>
<td>Debit</td>
<td>Branch</td>
<td>Retired</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2510</th>
<td>Debit</td>
<td>Online</td>
<td>Student</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2511</th>
<td>Credit</td>
<td>Online</td>
<td>Student</td>
</tr>
</tbody>
</table>

<p>2512 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning untuk kolom 'CustomerAge'</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>bins_age <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">35</span>, <span class="dv">60</span>, <span class="bu">float</span>(<span class="st">'inf'</span>)]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>labels_age <span class="op">=</span> [<span class="st">'Anak-anak'</span>, <span class="st">'Remaja'</span>, <span class="st">'Dewasa Muda'</span>, <span class="st">'Dewasa'</span>, <span class="st">'Lansia'</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'AgeCategory'</span>] <span class="op">=</span> pd.cut(df_cleaned[<span class="st">'CustomerAge'</span>], bins<span class="op">=</span>bins_age, labels<span class="op">=</span>labels_age, right<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisasi Distribusi Usia</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>age_bins <span class="op">=</span> [<span class="st">'Anak-anak'</span>, <span class="st">'Remaja'</span>, <span class="st">'Dewasa Muda'</span>, <span class="st">'Dewasa'</span>, <span class="st">'Lansia'</span>]</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>age_counts <span class="op">=</span> df_cleaned[<span class="st">'AgeCategory'</span>].value_counts().reindex(age_bins).fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>plt.bar(age_bins, age_counts.values)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribusi Usia Pelanggan"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Rentang Usia"</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Jumlah Pelanggan"</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, count <span class="kw">in</span> <span class="bu">enumerate</span>(age_counts.values):</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    plt.text(i, count, <span class="bu">str</span>(count), ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning AccountBalance</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>bins_balance <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">3000</span>, <span class="dv">6000</span>, <span class="dv">9000</span>, <span class="dv">12000</span>, <span class="dv">15000</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>labels_balance <span class="op">=</span> [<span class="st">'$ 0 - 3,000'</span>, <span class="st">'$ 3,001 - 6,000'</span>, <span class="st">'$ 6,001 - 9,000'</span>, <span class="st">'$ 9,001 - 12,000'</span>, <span class="st">'$ 12,001 - 15,000'</span>]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'BalanceCategory'</span>] <span class="op">=</span> pd.cut(df_cleaned[<span class="st">'AccountBalance'</span>], bins<span class="op">=</span>bins_balance, labels<span class="op">=</span>labels_balance, right<span class="op">=</span><span class="va">False</span>, include_lowest<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisasi Distribusi Saldo Akun</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>balance_bins <span class="op">=</span> [<span class="st">'$ 0 - 3,000'</span>, <span class="st">'$ 3,001 - 6,000'</span>, <span class="st">'$ 6,001 - 9,000'</span>, <span class="st">'$ 9,001 - 12,000'</span>, <span class="st">'$ 12,001 - 15,000'</span>]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>balance_counts <span class="op">=</span> df_cleaned[<span class="st">'BalanceCategory'</span>].value_counts().reindex(balance_bins).fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>plt.bar(balance_bins, balance_counts.values)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribusi Saldo Akun Pelanggan"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Saldo Akun"</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Jumlah Pelanggan"</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, count <span class="kw">in</span> <span class="bu">enumerate</span>(balance_counts.values):</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    plt.text(i, count, <span class="bu">str</span>(count), ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bandingkan outlier</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan quartile dan interquartile</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>q1 <span class="op">=</span> df_cleaned[numerical_cols].quantile(<span class="fl">0.25</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>q3 <span class="op">=</span> df_cleaned[numerical_cols].quantile(<span class="fl">0.75</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>IQR <span class="op">=</span> q3 <span class="op">-</span> q1</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan batas bawah dan atas untuk mendeteksi outlier</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="op">=</span> q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="op">=</span> q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan jumlah outlier per fitur</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> ((df_cleaned[numerical_cols] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (df_cleaned[numerical_cols] <span class="op">&gt;</span> upper_bound)).<span class="bu">sum</span>()</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(outliers)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>TransactionAmount      113
CustomerAge              0
TransactionDuration      0
LoginAttempts          122
AccountBalance           0
dtype: int64</code></pre>
</div>
</div>
<div id="cell-39" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengubah outlier ke batas terdekat mungkin lebih baik daripada menghapus utk clustering K-Means</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Data outlier TransactionAmount semuanya skewed ke arah frekuensi yang lebih tinggi</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cap_outliers(series):</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> series.quantile(<span class="fl">0.25</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> series.quantile(<span class="fl">0.75</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    capped_series <span class="op">=</span> np.where(series <span class="op">&lt;</span> lower_bound, lower_bound, series)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    capped_series <span class="op">=</span> np.where(capped_series <span class="op">&gt;</span> upper_bound, upper_bound, capped_series)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> capped_series</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Hanya menerapkan capping pada kolom 'TransactionAmount'</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'TransactionAmount'</span>] <span class="op">=</span> cap_outliers(df_cleaned[<span class="st">'TransactionAmount'</span>])</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Tampilkan beberapa baris pertama dari kolom 'TransactionAmount' setelah capping</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned[[<span class="st">'TransactionAmount'</span>]].head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   TransactionAmount
0              14.09
1             376.24
2             126.29
3             184.50
4              13.45</code></pre>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bandingkan outlier</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan quartile dan interquartile</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>q1 <span class="op">=</span> df_cleaned[numerical_cols].quantile(<span class="fl">0.25</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>q3 <span class="op">=</span> df_cleaned[numerical_cols].quantile(<span class="fl">0.75</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>IQR <span class="op">=</span> q3 <span class="op">-</span> q1</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan batas bawah dan atas untuk mendeteksi outlier</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="op">=</span> q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="op">=</span> q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan jumlah outlier per fitur</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> ((df_cleaned[numerical_cols] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (df_cleaned[numerical_cols] <span class="op">&gt;</span> upper_bound)).<span class="bu">sum</span>()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(outliers)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>TransactionAmount        0
CustomerAge              0
TransactionDuration      0
LoginAttempts          122
AccountBalance           0
dtype: int64</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_cleaned[numerical_cols] <span class="co"># ['TransactionAmount', 'CustomerAge', 'TransactionDuration', 'LoginAttempts', 'AccountBalance']</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>14.09</td>
<td>70</td>
<td>81</td>
<td>1</td>
<td>5112.21</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>376.24</td>
<td>68</td>
<td>141</td>
<td>1</td>
<td>13758.91</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>126.29</td>
<td>19</td>
<td>56</td>
<td>1</td>
<td>1122.35</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>184.50</td>
<td>26</td>
<td>25</td>
<td>1</td>
<td>8569.06</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>13.45</td>
<td>26</td>
<td>198</td>
<td>1</td>
<td>7429.40</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2507</th>
<td>856.21</td>
<td>33</td>
<td>109</td>
<td>1</td>
<td>12690.79</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2508</th>
<td>251.54</td>
<td>48</td>
<td>177</td>
<td>1</td>
<td>254.75</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2509</th>
<td>28.63</td>
<td>56</td>
<td>146</td>
<td>1</td>
<td>3382.91</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2510</th>
<td>185.97</td>
<td>23</td>
<td>19</td>
<td>1</td>
<td>1776.91</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2511</th>
<td>243.08</td>
<td>24</td>
<td>93</td>
<td>1</td>
<td>131.25</td>
</tr>
</tbody>
</table>

<p>2512 rows × 5 columns</p>
</div>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_cleaned[categorical_cols] <span class="co">#  ['TransactionType', 'Channel', 'CustomerOccupation']</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionType</th>
<th data-quarto-table-cell-role="th">Channel</th>
<th data-quarto-table-cell-role="th">CustomerOccupation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Debit</td>
<td>ATM</td>
<td>Doctor</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Debit</td>
<td>ATM</td>
<td>Doctor</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Debit</td>
<td>Online</td>
<td>Student</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Debit</td>
<td>Online</td>
<td>Student</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Credit</td>
<td>Online</td>
<td>Student</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2507</th>
<td>Credit</td>
<td>Branch</td>
<td>Doctor</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2508</th>
<td>Debit</td>
<td>Branch</td>
<td>Doctor</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2509</th>
<td>Debit</td>
<td>Branch</td>
<td>Retired</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2510</th>
<td>Debit</td>
<td>Online</td>
<td>Student</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2511</th>
<td>Credit</td>
<td>Online</td>
<td>Student</td>
</tr>
</tbody>
</table>

<p>2512 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-43" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hitung mean dan standar deviasi</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean per kolom:"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned[numerical_cols].mean())</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Standar Deviasi per kolom:"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned[numerical_cols].std())</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Hitung nilai minimum dan maksimum</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Minimum per kolom:"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned[numerical_cols].<span class="bu">min</span>())</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Maksimum per kolom:"</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned[numerical_cols].<span class="bu">max</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean per kolom:
TransactionAmount       284.847250
CustomerAge              44.673965
TransactionDuration     119.643312
LoginAttempts             1.124602
AccountBalance         5114.302966
dtype: float64

Standar Deviasi per kolom:
TransactionAmount       252.067285
CustomerAge              17.792198
TransactionDuration      69.963757
LoginAttempts             0.602662
AccountBalance         3900.942499
dtype: float64

Minimum per kolom:
TransactionAmount        0.26
CustomerAge             18.00
TransactionDuration     10.00
LoginAttempts            1.00
AccountBalance         101.25
dtype: float64

Maksimum per kolom:
TransactionAmount        913.49125
CustomerAge               80.00000
TransactionDuration      300.00000
LoginAttempts              5.00000
AccountBalance         14977.99000
dtype: float64</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Karena skala yang jauh antara kolom numerik, maka harus dilakukan standarisasi</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Standarisasi fitur numerik berdasarkan Z-score scaling</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformasi fitur numerik</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>df_scaled <span class="op">=</span> scaler.fit_transform(df_cleaned[numerical_cols])</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ubah kembali ke DataFrame</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>df_scaled <span class="op">=</span> pd.DataFrame(df_scaled, columns<span class="op">=</span> numerical_cols, index<span class="op">=</span> df_cleaned.index)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>df_scaled.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>-1.074361</td>
<td>1.423718</td>
<td>-0.552443</td>
<td>-0.206794</td>
<td>-0.000537</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>0.362645</td>
<td>1.311287</td>
<td>0.305314</td>
<td>-0.206794</td>
<td>2.216472</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>-0.629153</td>
<td>-1.443277</td>
<td>-0.909842</td>
<td>-0.206794</td>
<td>-1.023534</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>-0.398176</td>
<td>-1.049768</td>
<td>-1.353017</td>
<td>-0.206794</td>
<td>0.885797</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>-1.076900</td>
<td>-1.049768</td>
<td>1.120184</td>
<td>-0.206794</td>
<td>0.593589</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-45" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Encoding data kategorikal menggunakan One-Hot Encoding</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>ohe <span class="op">=</span> OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">'ignore'</span>, sparse_output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>ohe_data <span class="op">=</span> ohe.fit_transform(df_cleaned[categorical_cols])</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>ohe_feature_names <span class="op">=</span> ohe.get_feature_names_out(categorical_cols)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>df_ohe <span class="op">=</span> pd.DataFrame(ohe_data, columns<span class="op">=</span>ohe_feature_names, index<span class="op">=</span>df_cleaned.index)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gabungkan</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>df_cleaned <span class="op">=</span> pd.concat([df_scaled, df_ohe], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>df_cleaned</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">TransactionType_Credit</th>
<th data-quarto-table-cell-role="th">TransactionType_Debit</th>
<th data-quarto-table-cell-role="th">Channel_ATM</th>
<th data-quarto-table-cell-role="th">Channel_Branch</th>
<th data-quarto-table-cell-role="th">Channel_Online</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Doctor</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Engineer</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Retired</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Student</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>-1.074361</td>
<td>1.423718</td>
<td>-0.552443</td>
<td>-0.206794</td>
<td>-0.000537</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>0.362645</td>
<td>1.311287</td>
<td>0.305314</td>
<td>-0.206794</td>
<td>2.216472</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>-0.629153</td>
<td>-1.443277</td>
<td>-0.909842</td>
<td>-0.206794</td>
<td>-1.023534</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>-0.398176</td>
<td>-1.049768</td>
<td>-1.353017</td>
<td>-0.206794</td>
<td>0.885797</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>-1.076900</td>
<td>-1.049768</td>
<td>1.120184</td>
<td>-0.206794</td>
<td>0.593589</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2507</th>
<td>2.267159</td>
<td>-0.656259</td>
<td>-0.152156</td>
<td>-0.206794</td>
<td>1.942606</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2508</th>
<td>-0.132163</td>
<td>0.186975</td>
<td>0.819969</td>
<td>-0.206794</td>
<td>-1.245986</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2509</th>
<td>-1.016666</td>
<td>0.636700</td>
<td>0.376794</td>
<td>-0.206794</td>
<td>-0.443928</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2510</th>
<td>-0.392343</td>
<td>-1.218415</td>
<td>-1.438793</td>
<td>-0.206794</td>
<td>-0.855705</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2511</th>
<td>-0.165732</td>
<td>-1.162199</td>
<td>-0.380892</td>
<td>-0.206794</td>
<td>-1.277652</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>2512 rows × 14 columns</p>
</div>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning 'TransactionAmount' setelah standarisasi</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>), <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="bu">float</span>(<span class="st">'inf'</span>)] <span class="co"># Sesuaikan batas sesuai kebutuhan</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">'Sangat Rendah'</span>, <span class="st">'Rendah'</span>, <span class="st">'Tinggi'</span>, <span class="st">'Sangat Tinggi'</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>binned_sample <span class="op">=</span> pd.cut(df_cleaned[<span class="st">'TransactionAmount'</span>], bins<span class="op">=</span>bins, labels<span class="op">=</span>labels, right<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame({<span class="st">'TransactionAmount'</span>: df_cleaned[<span class="st">'TransactionAmount'</span>], <span class="st">'Binned'</span>: binned_sample}).sample(<span class="dv">5</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      TransactionAmount         Binned
452           -0.915800         Rendah
872           -0.477496         Rendah
730            0.577353         Rendah
1921          -1.071067  Sangat Rendah
2243           0.249121         Rendah</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_cleaned.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">TransactionType_Credit</th>
<th data-quarto-table-cell-role="th">TransactionType_Debit</th>
<th data-quarto-table-cell-role="th">Channel_ATM</th>
<th data-quarto-table-cell-role="th">Channel_Branch</th>
<th data-quarto-table-cell-role="th">Channel_Online</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Doctor</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Engineer</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Retired</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Student</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>-1.074361</td>
<td>1.423718</td>
<td>-0.552443</td>
<td>-0.206794</td>
<td>-0.000537</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>0.362645</td>
<td>1.311287</td>
<td>0.305314</td>
<td>-0.206794</td>
<td>2.216472</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>-0.629153</td>
<td>-1.443277</td>
<td>-0.909842</td>
<td>-0.206794</td>
<td>-1.023534</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>-0.398176</td>
<td>-1.049768</td>
<td>-1.353017</td>
<td>-0.206794</td>
<td>0.885797</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>-1.076900</td>
<td>-1.049768</td>
<td>1.120184</td>
<td>-0.206794</td>
<td>0.593589</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="pembangunan-model-clustering" class="level1">
<h1><strong>6. Pembangunan Model Clustering</strong></h1>
<section id="a.-pembangunan-model-clustering" class="level2">
<h2 class="anchored" data-anchor-id="a.-pembangunan-model-clustering"><strong>a. Pembangunan Model Clustering</strong></h2>
<p>Pada tahap ini, Anda membangun model clustering dengan memilih algoritma yang sesuai untuk mengelompokkan data berdasarkan kesamaan. Berikut adalah <strong>rekomendasi</strong> tahapannya. 1. Pilih algoritma clustering yang sesuai. 2. Latih model dengan data menggunakan algoritma tersebut.</p>
<div id="cell-51" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inisialisasi dan melatih model KMeans dengan jumlah cluster = 5</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">42</span>, n_init<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>kmeans.fit(df_cleaned)  <span class="co"># Latih pada kolom numerik</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mendapatkan label dan jumlah cluster</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> kmeans.labels_</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Menambahkan label cluster ke df_cleaned</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'Cluster'</span>] <span class="op">=</span> labels</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan distribusi cluster dalam bentuk tabel</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>cluster_counts <span class="op">=</span> df_cleaned[<span class="st">'Cluster'</span>].value_counts().sort_index()</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Distribusi Cluster:"</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cluster_counts)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Distribusi Cluster:
Cluster
0    704
1     95
2    362
3    662
4    689
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="b.-evaluasi-model-clustering" class="level2">
<h2 class="anchored" data-anchor-id="b.-evaluasi-model-clustering"><strong>b. Evaluasi Model Clustering</strong></h2>
<p>Untuk menentukan jumlah cluster yang optimal dalam model clustering, Anda dapat menggunakan metode Elbow atau Silhouette Score.</p>
<p>Metode ini membantu kita menemukan jumlah cluster yang memberikan pemisahan terbaik antar kelompok data, sehingga model yang dibangun dapat lebih efektif. Berikut adalah <strong>rekomendasi</strong> tahapannya. 1. Gunakan Silhouette Score dan Elbow Method untuk menentukan jumlah cluster optimal. 2. Hitung Silhouette Score sebagai ukuran kualitas cluster.</p>
<div id="cell-54" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inisialisasi supaya yg di KElbow tdk termasuk cluster</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>nocluster_cols <span class="op">=</span> df_cleaned.drop(columns<span class="op">=</span>[<span class="st">'Cluster'</span>]).columns</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan jumlah cluster yang optimal dg Elbow Method</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Inisialisasi model KMeans</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(random_state<span class="op">=</span><span class="dv">42</span>, n_init<span class="op">=</span><span class="dv">10</span>) <span class="co"># Tambahkan random_state untuk reproducibility</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Inisialisasi visualizer KElbow untuk menentukan jumlah cluster optimal</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>visualizer <span class="op">=</span> KElbowVisualizer(kmeans, k<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">11</span>)) <span class="co"># Rentang k disesuaikan (minimal 2 cluster)</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit visualizer dengan data yang di-scaling</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>visualizer.fit(df_cleaned[nocluster_cols])</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>visualizer.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df_nocluster <span class="op">=</span> df_cleaned.drop(columns<span class="op">=</span>[<span class="st">'Cluster'</span>])</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>sil_before <span class="op">=</span> silhouette_score(df_nocluster, labels)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Silhouette Score sebelum Feature Selection: </span><span class="sc">{</span>sil_before<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Silhouette Score sebelum Feature Selection: 0.1928</code></pre>
</div>
</div>
</section>
<section id="c.-feature-selection-opsional" class="level2">
<h2 class="anchored" data-anchor-id="c.-feature-selection-opsional"><strong>c.&nbsp;Feature Selection (Opsional)</strong></h2>
<p>Silakan lakukan feature selection jika Anda membutuhkan optimasi model clustering. Jika Anda menerapkan proses ini, silakan lakukan pemodelan dan evaluasi kembali menggunakan kolom-kolom hasil feature selection. Terakhir, bandingkan hasil performa model sebelum dan sesudah menerapkan feature selection.</p>
<div id="cell-58" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> VarianceThreshold</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>selector <span class="op">=</span> VarianceThreshold(threshold<span class="op">=</span><span class="fl">0.15</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>df_selected_variance <span class="op">=</span> selector.fit_transform(df_nocluster)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Elbow method</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#sil_scores = []</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># for k in range(2, 10):</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     labels = kmeans.fit_predict(df_selected_variance)</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     sil = silhouette_score(df_selected_variance, labels)</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     sil_scores.append(sil)</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(f"K: {k}, Silhouette Score: {sil:.4f}")</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>optimal_k <span class="op">=</span> <span class="dv">3</span>  <span class="co"># Atur setelah lihat output</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>kmeans_var <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>optimal_k, random_state<span class="op">=</span><span class="dv">42</span>, n_init<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>labels_var <span class="op">=</span> kmeans_var.fit_predict(df_selected_variance)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>sil_var <span class="op">=</span> silhouette_score(df_selected_variance, labels_var)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Silhouette Score (VarianceThreshold): </span><span class="sc">{</span>sil_var<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Silhouette Score (VarianceThreshold): 0.1982</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="35">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>kmeans_temp <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>optimal_k, random_state<span class="op">=</span><span class="dv">42</span>, n_init<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>labels_temp <span class="op">=</span> kmeans_temp.fit_predict(df_selected_variance)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestClassifier(</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">200</span>,   <span class="co"># Tambah jumlah pohon</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span><span class="dv">10</span>,       <span class="co"># Batasi kedalaman biar lebih general</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    min_samples_split<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>rf.fit(df_selected_variance, labels_temp)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>importances <span class="op">=</span> rf.feature_importances_</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>feature_indices <span class="op">=</span> np.argsort(importances)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>top_n <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>top_features <span class="op">=</span> feature_indices[:top_n]</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>df_selected_rf <span class="op">=</span> df_selected_variance[:, top_features]</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluasi KMeans lagi di fitur RF</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>kmeans_rf <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>optimal_k, random_state<span class="op">=</span><span class="dv">42</span>, n_init<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>labels_rf <span class="op">=</span> kmeans_rf.fit_predict(df_selected_rf)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>sil_rf <span class="op">=</span> silhouette_score(df_selected_rf, labels_rf)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Silhouette Score (RandomForest Feature Selection): </span><span class="sc">{</span>sil_rf<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Silhouette Score (RandomForest Feature Selection): 0.4616</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>poly <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>, interaction_only<span class="op">=</span><span class="va">True</span>, include_bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>df_poly <span class="op">=</span> poly.fit_transform(df_selected_rf)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>pca_poly <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>df_pca_poly <span class="op">=</span> pca_poly.fit_transform(df_poly)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>kmeans_poly <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>optimal_k, random_state<span class="op">=</span><span class="dv">42</span>, n_init<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>labels_poly <span class="op">=</span> kmeans_poly.fit_predict(df_pca_poly)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluasi cluster final</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>sil_poly <span class="op">=</span> silhouette_score(df_pca_poly, labels_poly)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Silhouette Score: </span><span class="sc">{</span>sil_poly<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribusi cluster</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Distribusi Cluster:"</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.Series(labels_poly).value_counts().sort_index())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Silhouette Score: 0.7403

Distribusi Cluster:
0    1859
1     626
2      27
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="d.-visualisasi-hasil-clustering" class="level2">
<h2 class="anchored" data-anchor-id="d.-visualisasi-hasil-clustering"><strong>d.&nbsp;Visualisasi Hasil Clustering</strong></h2>
<p>Setelah model clustering dilatih dan jumlah cluster optimal ditentukan, langkah selanjutnya adalah menampilkan hasil clustering melalui visualisasi.</p>
<p>Berikut adalah <strong>rekomendasi</strong> tahapannya. 1. Tampilkan hasil clustering dalam bentuk visualisasi, seperti grafik scatter plot atau 2D PCA projection.</p>
<div id="cell-63" class="cell" data-execution_count="37">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['TransactionID', 'AccountID', 'TransactionAmount', 'TransactionDate',
       'TransactionType', 'Location', 'DeviceID', 'IP Address', 'MerchantID',
       'Channel', 'CustomerAge', 'CustomerOccupation', 'TransactionDuration',
       'LoginAttempts', 'AccountBalance', 'PreviousTransactionDate'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-64" class="cell" data-execution_count="38">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tambahkan cluster label hasil akhir ke dataframe asli</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Cluster_Final'</span>] <span class="op">=</span> labels_poly </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>numerical_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'number'</span>]).columns</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df[numerical_cols], hue<span class="op">=</span><span class="st">'Cluster_Final'</span>, palette<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-39-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-65" class="cell" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df[<span class="st">'CustomerAge'</span>],</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df[<span class="st">'AccountBalance'</span>],</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'Cluster_Final'</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">'viridis'</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df,  <span class="co"># Menggunakan df(data mentah) sebagai data</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Hasil Clustering CustomerAge vs AccountBalance'</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'CustomerAge'</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'AccountBalance'</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-40-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-66" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df[<span class="st">'TransactionAmount'</span>],</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df[<span class="st">'AccountBalance'</span>],</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'Cluster_Final'</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">'viridis'</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>df  <span class="co"># Menggunakan df (data menntah)</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Hasil Clustering TransactionAmount vs AccountBalance'</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'TransactionAmount'</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'AccountBalance'</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-67" class="cell" data-execution_count="41">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduksi dimensi dengan PCA</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>pca_result <span class="op">=</span> pca.fit_transform(df[numerical_cols])</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Buat DataFrame dari hasil PCA</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>pca_df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>pca_result, columns<span class="op">=</span>[<span class="st">'Principal Component 1'</span>, <span class="st">'Principal Component 2'</span>])</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Tambahkan label cluster dari df_numerical ke pca_df</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>pca_df[<span class="st">'Cluster_Final'</span>] <span class="op">=</span> df[<span class="st">'Cluster_Final'</span>].values</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Buat scatter plot</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'Principal Component 1'</span>,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Principal Component 2'</span>,</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'Cluster_Final'</span>,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">'viridis'</span>,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>pca_df,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Hasil Clustering K-Means (2D PCA Projection - Data Mentah)'</span>)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Principal Component 1'</span>)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Principal Component 2'</span>)</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="e.-analisis-dan-interpretasi-hasil-cluster" class="level2">
<h2 class="anchored" data-anchor-id="e.-analisis-dan-interpretasi-hasil-cluster"><strong>e. Analisis dan Interpretasi Hasil Cluster</strong></h2>
<section id="interpretasi-target" class="level3">
<h3 class="anchored" data-anchor-id="interpretasi-target">Interpretasi Target</h3>
<p><strong>Tutorial: Melakukan Inverse Transform pada Data Target Setelah Clustering</strong></p>
<p>Setelah melakukan clustering dengan model <strong>KMeans</strong>, kita perlu mengembalikan data yang telah diubah (normalisasi, standarisasi, atau label encoding) ke bentuk aslinya. Berikut adalah langkah-langkahnya.</p>
<hr>
<p><strong>1. Tambahkan Hasil Label Cluster ke DataFrame</strong> Setelah mendapatkan hasil clustering, kita tambahkan label cluster ke dalam DataFrame yang telah dinormalisasi.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df_normalized[<span class="st">'Cluster'</span>] <span class="op">=</span> model_kmeans.labels_</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Lakukan Inverse Transform pada feature yang sudah dilakukan Labelisasi dan Standararisasi. Berikut code untuk melakukannya: label_encoder.inverse_transform(X_Selected[[‘Fitur’]])</p>
<p>Lalu masukkan ke dalam kolom dataset asli atau membuat dataframe baru</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>df_normalized[<span class="st">'Fitur'</span>] <span class="op">=</span> label_encoder.inverse_transform(df_normalized[[<span class="st">'Fitur'</span>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Masukkan Data yang Sudah Di-Inverse ke dalam Dataset Asli atau Buat DataFrame Baru</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df_original[<span class="st">'Fitur'</span>] <span class="op">=</span> df_normalized[<span class="st">'Fitur'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="cell-71" class="cell" data-execution_count="42">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionID</th>
<th data-quarto-table-cell-role="th">AccountID</th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">TransactionDate</th>
<th data-quarto-table-cell-role="th">TransactionType</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">DeviceID</th>
<th data-quarto-table-cell-role="th">IP Address</th>
<th data-quarto-table-cell-role="th">MerchantID</th>
<th data-quarto-table-cell-role="th">Channel</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">CustomerOccupation</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">PreviousTransactionDate</th>
<th data-quarto-table-cell-role="th">Cluster_Final</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>TX000001</td>
<td>AC00128</td>
<td>14.09</td>
<td>2023-04-11 16:29:14</td>
<td>Debit</td>
<td>San Diego</td>
<td>D000380</td>
<td>162.198.218.92</td>
<td>M015</td>
<td>ATM</td>
<td>70</td>
<td>Doctor</td>
<td>81</td>
<td>1</td>
<td>5112.21</td>
<td>2024-11-04 08:08:08</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>TX000002</td>
<td>AC00455</td>
<td>376.24</td>
<td>2023-06-27 16:44:19</td>
<td>Debit</td>
<td>Houston</td>
<td>D000051</td>
<td>13.149.61.4</td>
<td>M052</td>
<td>ATM</td>
<td>68</td>
<td>Doctor</td>
<td>141</td>
<td>1</td>
<td>13758.91</td>
<td>2024-11-04 08:09:35</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>TX000003</td>
<td>AC00019</td>
<td>126.29</td>
<td>2023-07-10 18:16:08</td>
<td>Debit</td>
<td>Mesa</td>
<td>D000235</td>
<td>215.97.143.157</td>
<td>M009</td>
<td>Online</td>
<td>19</td>
<td>Student</td>
<td>56</td>
<td>1</td>
<td>1122.35</td>
<td>2024-11-04 08:07:04</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>TX000004</td>
<td>AC00070</td>
<td>184.50</td>
<td>2023-05-05 16:32:11</td>
<td>Debit</td>
<td>Raleigh</td>
<td>D000187</td>
<td>200.13.225.150</td>
<td>M002</td>
<td>Online</td>
<td>26</td>
<td>Student</td>
<td>25</td>
<td>1</td>
<td>8569.06</td>
<td>2024-11-04 08:09:06</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>TX000005</td>
<td>AC00411</td>
<td>13.45</td>
<td>2023-10-16 17:51:24</td>
<td>Credit</td>
<td>Atlanta</td>
<td>D000308</td>
<td>65.164.3.100</td>
<td>M091</td>
<td>Online</td>
<td>26</td>
<td>Student</td>
<td>198</td>
<td>1</td>
<td>7429.40</td>
<td>2024-11-04 08:06:39</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2507</th>
<td>TX002508</td>
<td>AC00297</td>
<td>856.21</td>
<td>2023-04-26 17:09:36</td>
<td>Credit</td>
<td>Colorado Springs</td>
<td>D000625</td>
<td>21.157.41.17</td>
<td>M072</td>
<td>Branch</td>
<td>33</td>
<td>Doctor</td>
<td>109</td>
<td>1</td>
<td>12690.79</td>
<td>2024-11-04 08:11:29</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2508</th>
<td>TX002509</td>
<td>AC00322</td>
<td>251.54</td>
<td>2023-03-22 17:36:48</td>
<td>Debit</td>
<td>Tucson</td>
<td>D000410</td>
<td>49.174.157.140</td>
<td>M029</td>
<td>Branch</td>
<td>48</td>
<td>Doctor</td>
<td>177</td>
<td>1</td>
<td>254.75</td>
<td>2024-11-04 08:11:42</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2509</th>
<td>TX002510</td>
<td>AC00095</td>
<td>28.63</td>
<td>2023-08-21 17:08:50</td>
<td>Debit</td>
<td>San Diego</td>
<td>D000095</td>
<td>58.1.27.124</td>
<td>M087</td>
<td>Branch</td>
<td>56</td>
<td>Retired</td>
<td>146</td>
<td>1</td>
<td>3382.91</td>
<td>2024-11-04 08:08:39</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2510</th>
<td>TX002511</td>
<td>AC00118</td>
<td>185.97</td>
<td>2023-02-24 16:24:46</td>
<td>Debit</td>
<td>Denver</td>
<td>D000634</td>
<td>21.190.11.223</td>
<td>M041</td>
<td>Online</td>
<td>23</td>
<td>Student</td>
<td>19</td>
<td>1</td>
<td>1776.91</td>
<td>2024-11-04 08:12:22</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2511</th>
<td>TX002512</td>
<td>AC00009</td>
<td>243.08</td>
<td>2023-02-14 16:21:23</td>
<td>Credit</td>
<td>Jacksonville</td>
<td>D000215</td>
<td>59.127.135.25</td>
<td>M041</td>
<td>Online</td>
<td>24</td>
<td>Student</td>
<td>93</td>
<td>1</td>
<td>131.25</td>
<td>2024-11-04 08:07:49</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>2512 rows × 17 columns</p>
</div>
</div>
</div>
<div id="cell-72" class="cell" data-execution_count="43">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df_cleaned</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">TransactionType_Credit</th>
<th data-quarto-table-cell-role="th">TransactionType_Debit</th>
<th data-quarto-table-cell-role="th">Channel_ATM</th>
<th data-quarto-table-cell-role="th">Channel_Branch</th>
<th data-quarto-table-cell-role="th">Channel_Online</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Doctor</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Engineer</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Retired</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Student</th>
<th data-quarto-table-cell-role="th">Cluster</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>-1.074361</td>
<td>1.423718</td>
<td>-0.552443</td>
<td>-0.206794</td>
<td>-0.000537</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>3</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>0.362645</td>
<td>1.311287</td>
<td>0.305314</td>
<td>-0.206794</td>
<td>2.216472</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>-0.629153</td>
<td>-1.443277</td>
<td>-0.909842</td>
<td>-0.206794</td>
<td>-1.023534</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>-0.398176</td>
<td>-1.049768</td>
<td>-1.353017</td>
<td>-0.206794</td>
<td>0.885797</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>-1.076900</td>
<td>-1.049768</td>
<td>1.120184</td>
<td>-0.206794</td>
<td>0.593589</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2507</th>
<td>2.267159</td>
<td>-0.656259</td>
<td>-0.152156</td>
<td>-0.206794</td>
<td>1.942606</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2508</th>
<td>-0.132163</td>
<td>0.186975</td>
<td>0.819969</td>
<td>-0.206794</td>
<td>-1.245986</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>4</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2509</th>
<td>-1.016666</td>
<td>0.636700</td>
<td>0.376794</td>
<td>-0.206794</td>
<td>-0.443928</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>3</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2510</th>
<td>-0.392343</td>
<td>-1.218415</td>
<td>-1.438793</td>
<td>-0.206794</td>
<td>-0.855705</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2511</th>
<td>-0.165732</td>
<td>-1.162199</td>
<td>-0.380892</td>
<td>-0.206794</td>
<td>-1.277652</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>2512 rows × 15 columns</p>
</div>
</div>
</div>
</section>
<section id="inverse-data-jika-melakukan-normalisasistandardisasi" class="level3">
<h3 class="anchored" data-anchor-id="inverse-data-jika-melakukan-normalisasistandardisasi">Inverse Data Jika Melakukan Normalisasi/Standardisasi</h3>
<p>Inverse Transform untuk Data yang Distandarisasi Jika data numerik telah dinormalisasi menggunakan StandardScaler atau MinMaxScaler, kita bisa mengembalikannya ke skala asli:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df_normalized[[<span class="st">'Fitur_Numerik'</span>]] <span class="op">=</span> scaler.inverse_transform(df_normalized[[<span class="st">'Fitur_Numerik'</span>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="cell-75" class="cell" data-execution_count="44">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df_cleaned[<span class="st">'Cluster_Final'</span>] <span class="op">=</span> df[<span class="st">'Cluster_Final'</span>].values</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>df_cleaned.groupby(<span class="st">'Cluster_Final'</span>).mean()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">TransactionType_Credit</th>
<th data-quarto-table-cell-role="th">TransactionType_Debit</th>
<th data-quarto-table-cell-role="th">Channel_ATM</th>
<th data-quarto-table-cell-role="th">Channel_Branch</th>
<th data-quarto-table-cell-role="th">Channel_Online</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Doctor</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Engineer</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Retired</th>
<th data-quarto-table-cell-role="th">CustomerOccupation_Student</th>
<th data-quarto-table-cell-role="th">Cluster</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Cluster_Final</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>-0.012949</td>
<td>0.419216</td>
<td>-0.004583</td>
<td>-0.006816</td>
<td>0.357296</td>
<td>0.232921</td>
<td>0.767079</td>
<td>0.330285</td>
<td>0.346423</td>
<td>0.323292</td>
<td>0.333513</td>
<td>0.322754</td>
<td>0.322216</td>
<td>0.021517</td>
<td>1.707370</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>0.043827</td>
<td>-1.193360</td>
<td>0.020537</td>
<td>-0.188235</td>
<td>-1.017966</td>
<td>0.210863</td>
<td>0.789137</td>
<td>0.337061</td>
<td>0.343450</td>
<td>0.319489</td>
<td>0.015974</td>
<td>0.033546</td>
<td>0.000000</td>
<td>0.950479</td>
<td>3.769968</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>-0.124597</td>
<td>-1.195512</td>
<td>-0.160628</td>
<td>4.833578</td>
<td>-0.998784</td>
<td>0.111111</td>
<td>0.888889</td>
<td>0.296296</td>
<td>0.333333</td>
<td>0.370370</td>
<td>0.037037</td>
<td>0.148148</td>
<td>0.000000</td>
<td>0.814815</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-76" class="cell" data-execution_count="45">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse fitur numerik</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>scaled_features <span class="op">=</span> [<span class="st">'TransactionAmount'</span>, <span class="st">'CustomerAge'</span>, <span class="st">'TransactionDuration'</span>, </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'LoginAttempts'</span>, <span class="st">'AccountBalance'</span>]</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>df_inverse <span class="op">=</span> pd.DataFrame(scaler.inverse_transform(df_cleaned[scaled_features]), </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                          columns<span class="op">=</span>scaled_features)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse One-Hot Encoding</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>df_inverse[<span class="st">'TransactionType'</span>] <span class="op">=</span> df_cleaned[[<span class="st">'TransactionType_Credit'</span>, <span class="st">'TransactionType_Debit'</span>]] <span class="op">\</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                                .idxmax(axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">str</span>.replace(<span class="st">'TransactionType_'</span>, <span class="st">''</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>df_inverse[<span class="st">'Channel'</span>] <span class="op">=</span> df_cleaned[[<span class="st">'Channel_ATM'</span>, <span class="st">'Channel_Branch'</span>, <span class="st">'Channel_Online'</span>]] <span class="op">\</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                         .idxmax(axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">str</span>.replace(<span class="st">'Channel_'</span>, <span class="st">''</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>df_inverse[<span class="st">'CustomerOccupation'</span>] <span class="op">=</span> df_cleaned[[<span class="st">'CustomerOccupation_Doctor'</span>, <span class="st">'CustomerOccupation_Engineer'</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">'CustomerOccupation_Retired'</span>, <span class="st">'CustomerOccupation_Student'</span>]] <span class="op">\</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>                                   .idxmax(axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">str</span>.replace(<span class="st">'CustomerOccupation_'</span>, <span class="st">''</span>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-attach cluster column</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>df_inverse[<span class="st">'Cluster_Final'</span>] <span class="op">=</span> df_cleaned[<span class="st">'Cluster_Final'</span>].values</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>df_inverse.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
<th data-quarto-table-cell-role="th">TransactionType</th>
<th data-quarto-table-cell-role="th">Channel</th>
<th data-quarto-table-cell-role="th">CustomerOccupation</th>
<th data-quarto-table-cell-role="th">Cluster_Final</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>14.09</td>
<td>70.0</td>
<td>81.0</td>
<td>1.0</td>
<td>5112.21</td>
<td>Debit</td>
<td>ATM</td>
<td>Doctor</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>376.24</td>
<td>68.0</td>
<td>141.0</td>
<td>1.0</td>
<td>13758.91</td>
<td>Debit</td>
<td>ATM</td>
<td>Doctor</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>126.29</td>
<td>19.0</td>
<td>56.0</td>
<td>1.0</td>
<td>1122.35</td>
<td>Debit</td>
<td>Online</td>
<td>Student</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>184.50</td>
<td>26.0</td>
<td>25.0</td>
<td>1.0</td>
<td>8569.06</td>
<td>Debit</td>
<td>Online</td>
<td>Student</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>13.45</td>
<td>26.0</td>
<td>198.0</td>
<td>1.0</td>
<td>7429.40</td>
<td>Credit</td>
<td>Online</td>
<td>Student</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Setelah melakukan clustering, langkah selanjutnya adalah menganalisis karakteristik dari masing-masing cluster berdasarkan fitur yang tersedia.</p>
<p>Berikut adalah <strong>rekomendasi</strong> tahapannya. 1. Analisis karakteristik tiap cluster berdasarkan fitur yang tersedia (misalnya, distribusi nilai dalam cluster). 2. Berikan interpretasi: Apakah hasil clustering sesuai dengan ekspektasi dan logika bisnis? Apakah ada pola tertentu yang bisa dimanfaatkan?</p>
<div id="cell-78" class="cell" data-execution_count="46">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df_inverse_num <span class="op">=</span> df_inverse.select_dtypes(include<span class="op">=</span>[<span class="st">'number'</span>])</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>df_inverse_num.groupby(<span class="st">'Cluster_Final'</span>).mean()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TransactionAmount</th>
<th data-quarto-table-cell-role="th">CustomerAge</th>
<th data-quarto-table-cell-role="th">TransactionDuration</th>
<th data-quarto-table-cell-role="th">LoginAttempts</th>
<th data-quarto-table-cell-role="th">AccountBalance</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Cluster_Final</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>281.583993</td>
<td>52.131253</td>
<td>119.322754</td>
<td>1.120495</td>
<td>6507.818392</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>295.892310</td>
<td>23.445687</td>
<td>121.079872</td>
<td>1.011182</td>
<td>1144.065415</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>253.446713</td>
<td>23.407407</td>
<td>108.407407</td>
<td>4.037037</td>
<td>1218.878148</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-79" class="cell" data-execution_count="47">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pisahkan kolom numerik dan kategorikal</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> df_inverse.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).columns.drop(<span class="st">'Cluster_Final'</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="op">=</span> df_inverse.select_dtypes(exclude<span class="op">=</span><span class="st">'number'</span>).columns</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregasi</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>agg_num <span class="op">=</span> df_inverse.groupby(<span class="st">'Cluster_Final'</span>)[num_cols].agg([<span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'mean'</span>])</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>agg_cat <span class="op">=</span> df_inverse.groupby(<span class="st">'Cluster_Final'</span>)[cat_cols].agg(<span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>])</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten MultiIndex dari agg_num</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>agg_num.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col).strip() <span class="cf">if</span> col[<span class="dv">1</span>] <span class="cf">else</span> col[<span class="dv">0</span>] <span class="cf">for</span> col <span class="kw">in</span> agg_num.columns.values]</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Gabung semua summary</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>cluster_summary <span class="op">=</span> pd.merge(agg_num, agg_cat, on<span class="op">=</span><span class="st">'Cluster_Final'</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cluster_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>               TransactionAmount_min  TransactionAmount_max  \
Cluster_Final                                                 
0                               0.32              913.49125   
1                               0.26              913.49125   
2                              13.48              913.49125   

               TransactionAmount_mean  CustomerAge_min  CustomerAge_max  \
Cluster_Final                                                             
0                          281.583993             18.0             80.0   
1                          295.892310             18.0             36.0   
2                          253.446713             18.0             41.0   

               CustomerAge_mean  TransactionDuration_min  \
Cluster_Final                                              
0                     52.131253                     10.0   
1                     23.445687                     11.0   
2                     23.407407                     12.0   

               TransactionDuration_max  TransactionDuration_mean  \
Cluster_Final                                                      
0                                300.0                119.322754   
1                                299.0                121.079872   
2                                282.0                108.407407   

               LoginAttempts_min  LoginAttempts_max  LoginAttempts_mean  \
Cluster_Final                                                             
0                            1.0                5.0            1.120495   
1                            1.0                2.0            1.011182   
2                            3.0                5.0            4.037037   

               AccountBalance_min  AccountBalance_max  AccountBalance_mean  \
Cluster_Final                                                                
0                          120.89            14977.99          6507.818392   
1                          101.25             6568.59          1144.065415   
2                          271.78             5335.44          1218.878148   

              TransactionType Channel CustomerOccupation  
Cluster_Final                                             
0                       Debit  Branch             Doctor  
1                       Debit  Branch            Student  
2                       Debit  Online            Student  </code></pre>
</div>
</div>
<div id="cell-80" class="cell" data-execution_count="48">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df_inverse, x<span class="op">=</span><span class="st">'TransactionType'</span>, hue<span class="op">=</span><span class="st">'Cluster_Final'</span>, palette<span class="op">=</span> <span class="st">'crest'</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-81" class="cell" data-execution_count="49">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df_inverse, x<span class="op">=</span><span class="st">'Channel'</span>, hue<span class="op">=</span><span class="st">'Cluster_Final'</span>, palette<span class="op">=</span> <span class="st">'crest'</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-50-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-82" class="cell" data-execution_count="50">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df_inverse, x<span class="op">=</span><span class="st">'CustomerOccupation'</span>, hue<span class="op">=</span><span class="st">'Cluster_Final'</span>, palette<span class="op">=</span> <span class="st">'crest'</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-51-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-83" class="cell" data-execution_count="51">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df_inverse, hue<span class="op">=</span><span class="st">'Cluster_Final'</span>, palette<span class="op">=</span> <span class="st">'viridis'</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="[Clustering] Submission Akhir BMLP_Cinta Chantika Lestari_files/figure-html/cell-52-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Tulis hasil interpretasinya di sini.</p>
</section>
<section id="analisis-karakteristik-cluster-dari-model-kmeans" class="level3">
<h3 class="anchored" data-anchor-id="analisis-karakteristik-cluster-dari-model-kmeans">🔎 Analisis Karakteristik Cluster dari Model KMeans</h3>
<section id="cluster-0---wealthy-seniors-high-net-worth-customers" class="level4">
<h4 class="anchored" data-anchor-id="cluster-0---wealthy-seniors-high-net-worth-customers">Cluster 0 - “Wealthy Seniors” / “High Net-Worth Customers”</h4>
<ul>
<li>Karakteristik:
<ul>
<li>Usia rata-rata tertinggi (52 tahun)</li>
<li>Saldo rekening besar (6.500+)</li>
<li>Didominasi profesi Doctor, Engineer, dan Retired</li>
<li>Lebih banyak transaksi Debit</li>
<li>Memakai semua channel (ATM, Branch, Online) hampir merata</li>
</ul></li>
<li>Insight dan saran:
<ul>
<li>Segmen pelanggan mapan, stabil secara finansial</li>
<li>Potensi besar untuk cross-selling investasi, produk premium, atau asuransi pensiun</li>
</ul></li>
</ul>
</section>
<section id="cluster-1---young-regulars-active-students" class="level4">
<h4 class="anchored" data-anchor-id="cluster-1---young-regulars-active-students">Cluster 1 - “Young Regulars” / “Active Students”</h4>
<ul>
<li>Karakteristik:
<ul>
<li>Usia muda/produktif</li>
<li>Saldo kecil-menengah (sekitar 1.100-an)</li>
<li>Mayoritas Student</li>
<li>Transaksi Debit dominan</li>
<li>Channel seimbang, tapi volumenya tidak setinggi Cluster 0</li>
</ul></li>
<li>Insight dan saran:
<ul>
<li>Segmen anak muda aktif bertransaksi</li>
<li>Cocok untuk target produk digital banking, e-wallet, atau promo lifestyle</li>
</ul></li>
</ul>
</section>
<section id="cluster-2---high-risk-customers-potential-fraud-candidates" class="level4">
<h4 class="anchored" data-anchor-id="cluster-2---high-risk-customers-potential-fraud-candidates">Cluster 2 - “High-Risk Customers” / “Potential Fraud Candidates”</h4>
<p>Cluster 2 tergolong niche karena jumlah anggotanya sangat sedikit dibanding cluster lain dan memiliki karakteristik unik yang tidak umum. Meskipun usia dan saldo mirip dengan Cluster 1, perilaku mereka berbeda signifikan, terutama dari sisi login attempts yang sangat tinggi dan dominasi penggunaan channel online. Hal ini menunjukkan bahwa Cluster 2 berpotensi sebagai kelompok risky atau fraud candidates, dengan aktivitas yang tidak lazim dan lebih rawan terhadap penyalahgunaan akun. - Karakteristik: - Usia muda (23 tahun) - Login Attempts sangat tinggi (4 kali rata-rata, jauh lebih banyak dari cluster lain) - Saldo kecil-menengah - Jumlah transaksi sangat sedikit, dominasi di channel Online - Customer cenderung Student atau Engineer (jumlahnya kecil) - Risk/Fraud Insight: - Perilaku login tidak wajar (frekuensi login tinggi bisa mengindikasikan akun sering dicoba akses pihak ketiga atau user sendiri kurang paham keamanan) - Aktivitas transaksi minim; berpotensi akun nonaktif atau digunakan untuk tujuan non-transaksi biasa (seperti mule account untuk fraud) - Channel lebih dominan Online; lebih berisiko dari sisi keamanan data dan rawan cyber fraud - Rekomendasi: - Flag untuk monitoring lebih ketat - Terapkan 2FA lebih ketat - Perlu dilakukan anomaly detection di cluster ini - Campaign edukasi keamanan digital cocok untuk segmen ini</p>
</section>
</section>
</section>
</section>
<section id="mengeksport-data" class="level1">
<h1><strong>7. Mengeksport Data</strong></h1>
<p>Simpan hasilnya ke dalam file CSV.</p>
<div id="cell-88" class="cell" data-execution_count="52">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df_inverse.to_csv(<span class="st">'dataset_clustered.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>